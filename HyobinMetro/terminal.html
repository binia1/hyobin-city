<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>효빈종합버스터미널 정보</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts (Noto Sans KR) -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f7f9fa; }
        .info-card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            transition: all 0.3s;
            cursor: pointer;
        }
        .info-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .table-section {
            overflow-x: auto;
        }
        .table-section table {
            width: 100%;
            min-width: 600px;
        }
        .table-section th, .table-section td {
            padding: 0.9rem 0.5rem;
            border-bottom: 1px solid #e5e7eb;
            text-align: left;
            font-size: 0.9rem;
        }
        .table-section th {
            background-color: #eff6ff; /* blue-50 */
            font-weight: 700;
            color: #1e3a8a; /* blue-900 */
            white-space: nowrap;
        }
        .table-section tr:hover {
            background-color: #f0f9ff;
            cursor: pointer;
        }
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .tag-bus {
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
        }
        .tag-express { background-color: #fee2e2; color: #991b1b; } /* Red */
        .tag-intercity { background-color: #dcfce7; color: #166534; } /* Green */
        .tag-mixed { background-color: #fef9c3; color: #854d0e; } /* Yellow */
        
        /* Modal Content Typography */
        .prose strong { color: #1e40af; font-weight: 700; }
        .prose ul { list-style-type: disc; padding-left: 1.25rem; margin-top: 0.5rem; margin-bottom: 0.5rem; }
        .prose li { margin-bottom: 0.25rem; }
        .prose p { margin-bottom: 0.75rem; line-height: 1.6; }
    </style>
</head>
<body class="p-4 md:p-8 text-slate-800">
    <div class="max-w-7xl mx-auto">
        <header class="text-center mb-12 border-b-2 pb-4 border-blue-100">
            <h1 class="text-4xl md:text-5xl font-black text-blue-800">효빈종합버스터미널</h1>
            <p class="text-lg text-gray-500 mt-2">HYOBIN GENERAL BUS TERMINAL</p>
            <p class="mt-4 text-sm text-gray-600">효빈광역시 북구 해서동 322-2번지에 위치한 효빈시의 메인 교통 관문입니다.</p>
        </header>

        <!-- 1. 터미널 개요 -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 border-l-4 border-blue-500 pl-3">1. 터미널 개요</h2>
            <div class="info-card p-6 grid grid-cols-1 md:grid-cols-2 gap-x-10 gap-y-4" onclick="showGenericDetail('터미널 개요 상세', '<div class=\'prose\'> <p><strong>효빈종합버스터미널</strong>은 효빈광역시 북구 해서동 322-2번지에 위치한 <strong>효빈시 최대의 교통 허브</strong>입니다.</p> <ul> <li><strong>역사:</strong> 1966년 개업 후, 1996년 현 위치로 신축 이전하였으며, 2013년 대대적인 2차 리모델링을 거쳐 현재의 현대적인 모습을 갖췄습니다.</li> <li><strong>운영 구조:</strong> 터미널 부지와 건물은 <strong>(주)효빈신세계</strong>가 소유하고 있으며, 운영은 효빈시의 향토 기업인 <strong>칠양여객고속(주)</strong>가 전담하고 있습니다.</li> <li><strong>특징:</strong> 신세계백화점, 이마트, 메가박스, 대형 서점이 유기적으로 연결된 <strong>복합 환승 센터(M-Mec)</strong>로, 효빈시 북구 상권의 중심지이자 랜드마크 역할을 수행합니다.</li> </ul> </div>')">
                <div><span class="font-medium text-gray-500 block">터미널 코드</span> <span class="font-bold text-lg">790 | 효빈</span></div>
                <div><span class="font-medium text-gray-500 block">ARS / 대표전화</span> <span class="font-bold text-lg">079-360-8132</span></div>
                <div><span class="font-medium text-gray-500 block">소유주</span> <span class="font-bold text-lg text-green-600">(주)효빈신세계</span></div>
                <div><span class="font-medium text-gray-500 block">운영사</span> <span class="font-bold text-lg text-red-600">칠양여객고속(주)</span></div>
                <div class="md:col-span-2 mt-2 text-sm text-blue-500 flex items-center justify-end">
                    <i data-lucide="info" class="w-4 h-4 mr-1"></i> 자세히 보기
                </div>
            </div>
        </section>

        <!-- 2. 관내 터미널 및 정류소 -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 border-l-4 border-blue-500 pl-3">2. 관내 터미널 및 정류소</h2>
            <div class="info-card p-0 overflow-hidden">
                <table class="w-full table-auto">
                    <thead>
                        <tr>
                            <th class="w-1/4">구분</th>
                            <th class="w-3/4">목록</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="route-row" onclick="showGenericDetail('운영 터미널 상세 정보', '<div class=\'prose\'> <p>효빈광역시는 도시 확장에 따라 권역별로 터미널 기능을 분산하고 있습니다.</p> <ul> <li><strong>효빈종합(고속/시외)터미널:</strong> 북구 해서동에 위치한 메인 터미널입니다. 전국 주요 도시 및 공항 노선을 전담합니다.</li> <li><strong>효빈남부 터미널:</strong> 덕남권(서중, 방산 등) 연결을 보조하는 터미널로, 남구 지역 주민들의 편의를 돕고 있습니다.</li> <li><strong>효빈서부 터미널 (예정):</strong> 2030년 완공을 목표로 서부 신도시 지역에 신설될 예정이며, 서해안권 교통의 새로운 거점이 될 것입니다.</li> </ul> </div>')">
                            <td>터미널</td>
                            <td>효빈고속 ･ 효빈시외 ･ 효빈남부 ･ 효빈서부(예정)</td>
                        </tr>
                        <tr class="route-row" onclick="showGenericDetail('주요 정류소 상세 정보', '<div class=\'prose\'> <p>효빈시는 터미널까지의 이동 시간을 단축하기 위해 시내 주요 거점에 <strong>중간 정차 정류소</strong>를 운영하고 있습니다.</p> <ul> <li><strong>중수역, 이자공원역:</strong> 도시철도와의 환승이 용이하여 출퇴근 시간대 이용률이 높습니다.</li> <li><strong>창전구청, 도변:</strong> 행정 중심지 및 대단지 아파트 밀집 지역의 수요를 담당합니다.</li> <li><strong>탄성, 북효빈, 평당:</strong> 북부권 외곽 지역 주민들의 시외 이동 편의를 위해 설치되었습니다.</li> <li><strong>북효빈 정류소:</strong> 2027년 정식 환승 센터로 승격되어 신설될 예정입니다.</li> </ul> </div>')">
                            <td>정류소</td>
                            <td>중수역 ･ 이자공원역 ･ 창전구청 ･ 도변 ･ 탄성 ･ 북효빈 ･ 평당</td>
                        </tr>
                        <tr class="route-row" onclick="showGenericDetail('기타 시설 정보', '<div class=\'prose\'> <p><strong>북효빈역 임시정류소</strong></p> <p>북효빈 정류소(2027년 완공 예정)가 신설되기 전까지 운영되는 임시 시설입니다. 북효빈역 3번 출구 앞 광장에 매표소와 대기실이 마련되어 있으며, 주로 수도권 및 강원권 노선이 정차합니다.</p> </div>')">
                            <td>기타</td>
                            <td>북효빈역 임시정류소 (북효빈정류소 신설 이전까지 운영)</td>
                        </tr>
                        <tr class="route-row" onclick="showGenericDetail('폐지된 시설 이력', '<div class=\'prose\'> <p>도시철도 확장 및 터미널 통합 계획에 따라 다음 시설들은 운영이 종료되었습니다.</p> <ul> <li><strong>(구)효빈고속, (구)효빈시외:</strong> 1996년 현재의 통합 터미널로 이전하면서 폐쇄되었습니다. 구 부지는 현재 해서시장 및 주상복합단지로 개발되었습니다.</li> <li><strong>북효빈 터미널:</strong> 시설 노후화 및 북효빈역 환승센터 계획으로 인해 폐지되었습니다.</li> <li><strong>창선역, 안천, 우전 정류소:</strong> 도시철도 3, 5호선 개통으로 인한 이용객 감소로 2018년 폐지되었습니다.</li> </ul> </div>')">
                            <td>폐지</td>
                            <td>(터미널) (구)효빈고속, 북효빈, (구)효빈시외 / (정류소) 창선역, 안천, 우전</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="text-sm text-gray-500 mt-2 p-2">※ 효빈서부 터미널 신설 예정(2030), 북효빈정류소 신설 예정(2027), 평당정류소 계획 중(미정)</p>
        </section>

        <!-- 3. 터미널 역사 -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 border-l-4 border-blue-500 pl-3">3. 터미널 역사</h2>
            <div class="space-y-4 text-gray-700">
                <div class="info-card" onclick="openInfoModal('history_1')">
                    <h3 class="text-xl font-bold text-blue-700 mb-2">3.1. 태동기: 구 터미널 시절 (1966~1995)</h3>
                    <p class="text-sm">구도심(현 해서시장)에 위치했던 시절. 도시 성장과 함께 시설 포화 문제로 이전을 추진했습니다.</p>
                </div>
                <div class="info-card" onclick="openInfoModal('history_2')">
                    <h3 class="text-xl font-bold text-blue-700 mb-2">3.2. 확장기: 신축 이전과 '신세계'의 개발 (1996~2005)</h3>
                    <p class="text-sm">현 위치로 이전하며 신세계그룹과의 협력을 통해 복합 문화 공간의 기반을 다진 시기입니다.</p>
                </div>
                <div class="info-card bg-red-50 border-l-4 border-red-500" onclick="openInfoModal('history_3')">
                    <h3 class="text-xl font-bold text-red-700 mb-2">3.3. 암흑기: 윤대환 시정의 폭리와 카르텔 (2006~2007)</h3>
                    <p class="text-sm">윤대환 시장 일가의 두청운수 독점, 요금 폭리, 그리고 칠양여객 탄압으로 얼룩진 시기입니다.</p>
                </div>
                <div class="info-card bg-green-50 border-l-4 border-green-500" onclick="openInfoModal('history_4')">
                    <h3 class="text-xl font-bold text-green-700 mb-2">3.4. 완성기: 칠양여객의 운영권 획득 (2008~현재)</h3>
                    <p class="text-sm">칠양여객이 운영권을 획득하고 신세계의 지원 속에 현재의 복합 문화 터미널로 완성된 시기입니다.</p>
                </div>
            </div>
        </section>

        <!-- 4. 운행 노선 및 요금 -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 border-l-4 border-blue-500 pl-3">4. 운행 노선 및 요금 (최신 반영)</h2>
            <div class="info-card p-0 overflow-hidden">
                <div class="p-4 bg-yellow-50 text-sm text-yellow-800 border-b border-yellow-100">
                    <i data-lucide="alert-circle" class="w-4 h-4 inline mr-1"></i>
                    <strong>안내:</strong> 행을 클릭하면 상세 시간표 확인 및 예매가 가능합니다. 표시된 요금은 정가 기준입니다.
                </div>
                <div class="table-section">
                    <table>
                        <thead>
                            <tr>
                                <th class="w-16">구분</th>
                                <th>행선지</th>
                                <th class="w-20">권역</th>
                                <th>운행 횟수</th>
                                <th>운수 회사</th>
                                <th>거리(km)</th>
                                <th>일반</th>
                                <th>우등</th>
                            </tr>
                        </thead>
                        <tbody id="route-table-body">
                            <!-- JS로 데이터 로드됨 -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- 5. 복합 문화 시설 -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 border-l-4 border-blue-500 pl-3">5. 복합 문화 시설 (서브컬처 성지)</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="info-card bg-purple-50" onclick="openInfoModal('culture_shopping')">
                    <h3 class="text-2xl font-bold text-purple-700 mb-2">쇼핑 & 서점 (신세계/이마트/교보)</h3>
                    <p class="text-gray-600">건담베이스, 일렉트로마트, 라이트노벨 전문관 입점</p>
                    <p class="text-sm text-purple-500 mt-2 font-bold">자세히 보기 &rarr;</p>
                </div>
                
                <div class="info-card bg-pink-50" onclick="openInfoModal('culture_otaku')">
                    <h3 class="text-2xl font-bold text-pink-700 mb-2">칠양여객의 '덕업일치' 공간</h3>
                    <p class="text-gray-600">콜라보 카페, 굿즈샵, 메가박스, 게임센터</p>
                    <p class="text-sm text-pink-500 mt-2 font-bold">자세히 보기 &rarr;</p>
                </div>
            </div>
        </section>

        <!-- 6. 교통 연계 -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 border-l-4 border-blue-500 pl-3">6. 교통 연계</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="info-card" onclick="openInfoModal('transport_subway')">
                    <h3 class="text-xl font-bold text-gray-700 mb-2 flex items-center"><i data-lucide="train" class="w-5 h-5 mr-2 text-blue-600"></i> 도시철도</h3>
                    <p class="text-sm text-gray-600">3호선/5호선 고속버스터미널(해서)역 지하 직결</p>
                </div>
                <div class="info-card" onclick="openInfoModal('transport_taxi')">
                    <h3 class="text-xl font-bold text-gray-700 mb-2 flex items-center"><i data-lucide="car" class="w-5 h-5 mr-2 text-blue-600"></i> 자가용/택시</h3>
                    <p class="text-sm text-gray-600">3,000대 주차장 / 전면 택시 승강장</p>
                </div>
                <div class="info-card" onclick="openInfoModal('transport_platform')">
                    <h3 class="text-xl font-bold text-gray-700 mb-2 flex items-center"><i data-lucide="building-2" class="w-5 h-5 mr-2 text-blue-600"></i> 승차장 구분</h3>
                    <p class="text-sm text-gray-600">1층 고속 / 2층 시외 / 후면 하차장</p>
                </div>
            </div>
        </section>

        <!-- 7. 여담 -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold text-red-700 mb-6 border-l-4 border-red-500 pl-3">7. 여담: 칠양여객과 윤대환의 악연</h2>
            <div class="space-y-4 text-gray-700">
                <div class="info-card bg-red-50/50" onclick="openInfoModal('trivia_1')">
                    <h3 class="text-xl font-bold text-red-700 mb-2">성공한 덕후의 복수와 '품격' 논쟁</h3>
                    <p class="text-sm">"품격? 웃기지도 않는 소리." 덕후 사장의 통쾌한 복수극.</p>
                </div>
                <div class="info-card" onclick="openInfoModal('trivia_2')">
                    <h3 class="text-xl font-bold text-red-700 mb-2">2017년 '요우소로' 사건: 와타나베 요우 버스 테러</h3>
                    <p class="text-sm">전직 시장의 굴욕과 '요우소로'의 승리.</p>
                </div>
                <div class="info-card" onclick="openInfoModal('trivia_3')">
                    <h3 class="text-xl font-bold text-red-700 mb-2">2023년 리엘라 버스 테러 미수 사건</h3>
                    <p class="text-sm">정치적 몰락의 결정타가 된 '그 사건'.</p>
                </div>
            </div>
        </section>

        <!-- Back Button -->
        <div class="mt-12 text-center">
            <a href="index.html" class="inline-flex items-center px-8 py-3 bg-blue-600 text-white font-bold rounded-full hover:bg-blue-700 transition">
                <i data-lucide="arrow-left" class="w-5 h-5 mr-2"></i> 메인으로 돌아가기
            </a>
        </div>
    </div>
    
    <!-- Generic Detail Modal -->
    <div id="generic-modal" class="modal-overlay hidden" onclick="closeModal('generic-modal')">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg p-6 transform scale-95 opacity-0 transition-all duration-300" id="generic-modal-wrapper" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center mb-4 border-b pb-2">
                <h3 id="generic-modal-title" class="text-2xl font-black text-gray-800">상세 정보</h3>
                <button onclick="closeModal('generic-modal')"><i data-lucide="x" class="w-6 h-6 text-gray-500 hover:text-red-500 transition"></i></button>
            </div>
            <div id="generic-modal-content" class="text-gray-700 text-base leading-relaxed">
                <!-- Content will be injected here -->
            </div>
             <div class="mt-6 text-right">
                <button onclick="closeModal('generic-modal')" class="px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg transition font-bold">닫기</button>
            </div>
        </div>
    </div>

    <!-- Booking Flow Modal -->
    <div id="booking-modal" class="modal-overlay hidden" onclick="closeModal('booking-modal')">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden transform scale-95 opacity-0 transition-all duration-300" id="booking-modal-wrapper" onclick="event.stopPropagation()">
            <div class="bg-blue-600 p-4 flex justify-between items-center text-white">
                <h3 id="booking-title" class="text-xl font-bold">노선 예매</h3>
                <button onclick="closeModal('booking-modal')"><i data-lucide="x" class="w-6 h-6 hover:text-blue-200 transition"></i></button>
            </div>
            <div id="booking-content" class="p-6"></div>
        </div>
    </div>

    <script>
        lucide.createIcons();

        // --- 상세 정보 데이터 (HTML 태그 제거를 위해 JS 객체로 관리) ---
        const detailsData = {
            'overview': {
                title: '터미널 개요 상세',
                content: `<div class='prose'> <p><strong>효빈종합버스터미널</strong>은 효빈광역시 북구 해서동 322-2번지에 위치한 <strong>효빈시 최대의 교통 허브</strong>입니다.</p> <ul> <li><strong>역사:</strong> 1966년 개업 후, 1996년 현 위치로 신축 이전하였으며, 2013년 대대적인 2차 리모델링을 거쳐 현재의 현대적인 모습을 갖췄습니다.</li> <li><strong>운영 구조:</strong> 터미널 부지와 건물은 <strong>(주)효빈신세계</strong>가 소유하고 있으며, 운영은 효빈시의 향토 기업인 <strong>칠양여객고속(주)</strong>가 전담하고 있습니다.</li> <li><strong>특징:</strong> 신세계백화점, 이마트, 메가박스, 대형 서점이 유기적으로 연결된 <strong>복합 환승 센터(M-Mec)</strong>로, 효빈시 북구 상권의 중심지이자 랜드마크 역할을 수행합니다.</li> </ul> </div>`
            },
            'terminals': {
                title: '운영 터미널 상세 정보',
                content: `<div class='prose'> <p>효빈광역시는 도시 확장에 따라 권역별로 터미널 기능을 분산하고 있습니다.</p> <ul> <li><strong>효빈종합(고속/시외)터미널:</strong> 북구 해서동에 위치한 메인 터미널입니다. 전국 주요 도시 및 공항 노선을 전담합니다.</li> <li><strong>효빈남부 터미널:</strong> 덕남권(서중, 방산 등) 연결을 보조하는 터미널로, 남구 지역 주민들의 편의를 돕고 있습니다.</li> <li><strong>효빈서부 터미널 (예정):</strong> 2030년 완공을 목표로 서부 신도시 지역에 신설될 예정이며, 서해안권 교통의 새로운 거점이 될 것입니다.</li> </ul> </div>`
            },
            'stops': {
                title: '주요 정류소 상세 정보',
                content: `<div class='prose'> <p>효빈시는 터미널까지의 이동 시간을 단축하기 위해 시내 주요 거점에 <strong>중간 정차 정류소</strong>를 운영하고 있습니다.</p> <ul> <li><strong>중수역, 이자공원역:</strong> 도시철도와의 환승이 용이하여 출퇴근 시간대 이용률이 높습니다.</li> <li><strong>창전구청, 도변:</strong> 행정 중심지 및 대단지 아파트 밀집 지역의 수요를 담당합니다.</li> <li><strong>탄성, 북효빈, 평당:</strong> 북부권 외곽 지역 주민들의 시외 이동 편의를 위해 설치되었습니다.</li> <li><strong>북효빈 정류소:</strong> 2027년 정식 환승 센터로 승격되어 신설될 예정입니다.</li> </ul> </div>`
            },
            'etc_stops': {
                title: '기타 시설 정보',
                content: `<div class='prose'> <p><strong>북효빈역 임시정류소</strong></p> <p>북효빈 정류소(2027년 완공 예정)가 신설되기 전까지 운영되는 임시 시설입니다. 북효빈역 3번 출구 앞 광장에 매표소와 대기실이 마련되어 있으며, 주로 수도권 및 강원권 노선이 정차합니다.</p> </div>`
            },
            'closed_stops': {
                title: '폐지된 시설 이력',
                content: `<div class='prose'> <p>도시철도 확장 및 터미널 통합 계획에 따라 다음 시설들은 운영이 종료되었습니다.</p> <ul> <li><strong>(구)효빈고속, (구)효빈시외:</strong> 1996년 현재의 통합 터미널로 이전하면서 폐쇄되었습니다. 구 부지는 현재 해서시장 및 주상복합단지로 개발되었습니다.</li> <li><strong>북효빈 터미널:</strong> 시설 노후화 및 북효빈역 환승센터 계획으로 인해 폐지되었습니다.</li> <li><strong>창선역, 안천, 우전 정류소:</strong> 도시철도 3, 5호선 개통으로 인한 이용객 감소로 2018년 폐지되었습니다.</li> </ul> </div>`
            },
            'history_1': {
                title: '3.1. 태동기: 구 터미널 시절 (1966~1995)',
                content: `<div class='prose'> <p><strong>위치:</strong> 효빈시 북구 해서동 191-2 (현 해서시장 부지)</p> <p>1966년 2월, 단층 콘크리트 건물의 공용 정류장으로 시작했습니다. 초기에는 효빈군의 시골 버스 정류장 수준이었으나, 1980년대 효빈시가 공업 도시로 급격히 성장하면서 이용객이 폭주했습니다. 좁은 진입로와 시설 부족으로 인해 북구 일대 교통 체증의 주범이 되었고, 시민들의 이전 요구가 빗발쳤던 시기입니다.</p> </div>`
            },
            'history_2': {
                title: '3.2. 확장기: 신축 이전과 \'신세계\'의 개발 (1996~2005)',
                content: `<div class='prose'> <p><strong>위치:</strong> 효빈시 북구 해서동 322-2 (현 위치)</p> <p>1996년 7월, 현재의 위치로 대규모 신축 이전을 단행했습니다. 당시 효빈시 진출을 노리던 <strong>신세계그룹</strong>과 사전 협의를 통해 백화점이 연결될 수 있는 구조로 광활하게 부지를 확보했습니다. 2000년대 초반 박현만 시장 재임 시기에 백화점 입점이 최종 확정되면서, 단순 교통 시설을 넘어선 <strong>복합 문화 공간(Complex)</strong>으로서의 기틀을 마련했습니다.</p> </div>`
            },
            'history_3': {
                title: '3.3. 암흑기: 윤대환 시정의 폭리와 카르텔 (2006~2007)',
                content: `<div class='prose'> <p>민선 4기 <strong>윤대환 시장</strong> 재임 시절은 효빈 터미널의 <strong>암흑기</strong>였습니다.</p> <ul> <li><strong>사익 추구:</strong> 윤 시장 일가가 소유한 '두청운수'의 이익을 위해 국책 사업인 빈효선 전철을 백지화시켰습니다.</li> <li><strong>폭리 및 횡포:</strong> 독점적 지위를 이용해 요금을 기습 인상하고, 배차를 고의로 줄여 콩나물시루 같은 '가축 수송'을 일상화했습니다.</li> <li><strong>문화 탄압:</strong> 당시 선진적인 서브컬처 마케팅을 시도하던 칠양여객을 "시의 품격을 떨어뜨린다"며 행정적으로 탄압하고 사업을 강제 중단시켰습니다.</li> </ul> </div>`
            },
            'history_4': {
                title: '3.4. 완성기: 칠양여객의 운영권 획득 (2008~현재)',
                content: `<div class='prose'> <p>2007년 시민들의 거센 불매 운동과 신세계의 계약 해지 통보로 윤대환 체제가 무너졌습니다.</p> <ul> <li><strong>새로운 시작:</strong> 2008년 복귀한 박현만 시장 하에, 평소 투명한 회계와 도덕적인 경영을 보여준 <strong>칠양여객</strong>이 만장일치로 새 운영사로 선정되었습니다.</li> <li><strong>전폭적인 지원:</strong> 신세계는 칠양여객을 "구세주"로 환영하며 리모델링 비용의 70%를 지원했습니다.</li> <li><strong>현재:</strong> 칠양여객의 주도 하에 쾌적한 시설과 독창적인 문화 콘텐츠가 어우러진, 전국에서도 손꼽히는 명품 터미널로 거듭났습니다.</li> </ul> </div>`
            },
            'culture_shopping': {
                title: '쇼핑, 서점 및 애니메이션 콘텐츠',
                content: `<div class='prose'> <p>효빈터미널은 쇼핑과 취미 생활이 공존하는 이색적인 공간입니다.</p> <ul> <li><strong>효빈신세계백화점 (고속구역 연결):</strong> 7층 남성 패션관 한편에 <strong>'건담 베이스'</strong>와 하이엔드 피규어 샵이 입점해 있습니다. 명품 쇼핑과 키덜트 취미를 동시에 즐길 수 있는 파격적인 구성을 자랑합니다.</li> <li><strong>이마트 효빈터미널점 (시외구역 연결):</strong> 4층 완구 코너 옆에 대규모 <strong>'일렉트로마트'</strong>가 있습니다. 내부에는 최신 게임 체험존과 가챠샵(캡슐 토이)이 별도로 마련되어 있어 여행객들의 발길을 잡습니다.</li> <li><strong>교보문고 효빈터미널점:</strong> 고속터미널 2층 대합실과 연결되어 있습니다. 특히 <strong>라이트 노벨 및 코믹스 섹션</strong>이 서울 광화문점 수준으로 특화되어 있어, 신간 발매일에는 학생들이 줄을 서는 진풍경이 벌어집니다.</li> </ul> </div>`
            },
            'culture_otaku': {
                title: '칠양여객의 \'덕업일치\' 공간 상세',
                content: `<div class='prose'> <p>운영사 칠양여객이 작정하고 만든 <strong>'덕후들의 성지'</strong>입니다.</p> <ul> <li><strong>터미널 캐릭터 굿즈샵 (Chilyang Factory):</strong> 칠양여객 마스코트 및 자체 제작 오리지널 캐릭터 굿즈를 판매합니다. 탈 지방급 퀄리티로 온라인 통판까지 진행합니다.</li> <li><strong>애니메이션 콜라보 카페 (Ani-Station):</strong> 자매결연 도시인 일본 누마즈(러브라이브! 선샤인!!), 가나자와(하스노소라) 배경 작품 및 뱅드림! 등 인기 IP와 공식 콜라보를 상시 진행합니다. 주말에는 대기열이 발생할 정도로 인기가 높습니다.</li> <li><strong>메가박스 효빈터미널점:</strong> 일명 <strong>'특전의 성지'</strong>. 애니메이션 극장판 개봉 시 특전 물량을 효빈시에서 가장 많이 확보하는 지점으로, 개봉일 새벽부터 오픈런 행렬이 이어집니다.</li> <li><strong>게임 센터 (Fun City):</strong> maimai, 츄니즘 등 수도권 성지급 리듬 게임 기기 라인업을 갖추어 전국 리듬 게이머들의 원정 코스로 유명합니다.</li> </ul> </div>`
            },
            'transport_subway': {
                title: '도시철도 연계 정보',
                content: `<div class='prose'> <p>효빈종합버스터미널은 효빈 도시철도 3호선과 5호선이 만나는 교통의 요지입니다.</p> <ul> <li><strong>고속버스터미널(해서)역 (3호선):</strong> 역 번호 311. 터미널 지하 3층과 직결되어 있어 비를 맞지 않고 이동이 가능합니다. 효빈국제공항 및 북효빈 접근성이 뛰어납니다.</li> <li><strong>고속버스터미널(해서)역 (5호선):</strong> 역 번호 506. 터미널 지하 2층과 직결됩니다. 청덕공원 및 포성산 방향 승객들이 주로 이용합니다.</li> </ul> </div>`
            },
            'transport_taxi': {
                title: '자가용 및 택시 정보',
                content: `<div class='prose'> <ul> <li><strong>주차장:</strong> 터미널 후면에 3,000대를 동시 수용할 수 있는 대형 공용 주차장이 완비되어 있습니다. (환승 이용객 주차비 50% 할인)</li> <li><strong>택시:</strong> 터미널 전면 광장에 대형 택시 승강장이 위치하여 대기 없이 편리하게 이용 가능합니다.</li> </ul> </div>`
            },
            'transport_platform': {
                title: '승차장 및 하차장 구분',
                content: `<div class='prose'> <p>효빈터미널은 혼잡을 방지하기 위해 층별로 승차장을 분리 운영합니다.</p> <ul> <li><strong>1층 승차장:</strong> 고속버스 전용 (서울, 부산, 대구, 광주, 전주 등 주요 광역 노선)</li> <li><strong>2층 승차장:</strong> 시외버스 전용 (덕남/덕북권, 강원, 충청, 경기 등 시외 직행 및 완행 노선)</li> <li><strong>하차장:</strong> 터미널 건물 후면에 별도로 위치하여 승차객과 동선이 겹치지 않습니다.</li> </ul> </div>`
            },
            'trivia_1': {
                title: '성공한 덕후의 복수와 품격 논쟁',
                content: `<div class='prose'> <p>칠양여객 옥덕호 대표는 윤대환 전 시장 재임 시절(2006년), 야심 차게 준비했던 '에반게리온 래핑 버스' 사업을 "시의 품격을 떨어뜨리는 쓰레기 같은 만화"라는 모욕과 함께 불허당했습니다. 이에 굴하지 않고 옥 대표는 터미널 운영권을 획득한 후, 터미널 곳곳을 애니메이션 콘텐츠로 채워 '덕질의 전당'으로 만듦으로써 윤 전 시장에게 보란 듯이 복수했습니다.</p> </div>`
            },
            'trivia_2': {
                title: '2017년 \'요우소로\' 참교육 사건',
                content: `<div class='prose'> <p>2017년, 출소한 윤대환이 앙심을 품고 터미널에 전시된 <strong>와타나베 요우(러브라이브! 선샤인!!)</strong> 래핑 버스에 침을 뱉는 테러를 감행했습니다.</p> <p>이를 CCTV로 목격한 옥 대표가 야구방망이를 들고 뛰쳐나왔고, 주변 시민들마저 "버스로 밀어버립시다!"라며 옥 대표를 응원했습니다. 공포에 질린 윤대환은 바지에 오줌을 지리고 도망쳤습니다.</p> <p>이 사건 후 성우 사이토 슈카는 <strong>"정의는 승리하는 법이죠! 요소로~!"</strong>라며 간접적인 지지를 보내 화제가 되었습니다.</p> </div>`
            },
            'trivia_3': {
                title: '2023년 리엘라 버스 테러 미수 사건',
                content: `<div class='prose'> <p>2023년, 윤대환과 그의 아들 윤재훈이 <strong>Liella! (러브라이브! 슈퍼스타!!)</strong> 래핑 버스에 오물을 투척하려다 현장에 있던 <strong>효빈고속의 근육질 정비 직원(아라시 치사토 오시)</strong>에게 제압당한 사건입니다.</p> <p>윤재훈은 직원의 압도적인 피지컬에 충격을 받아 바지에 대변을 지리고 말았으며, "만마루처럼 접어버리겠다"는 직원의 일갈에 혼비백산했습니다. 이 사건으로 윤재훈은 '똥재훈'이라는 불명예스러운 별명을 얻으며 2024년 총선에서 낙선, 정치적 생명이 끝났습니다.</p> </div>`
            }
        };

        // 1. 노선 데이터 정의 (최종 업데이트)
        const rawRouteData = [
            // 덕북권
            { type: '시외', dest: '강주', region: '덕북권', freq: '18회', company: '청엽, 소진', dist: 47.75, normal: 5000, premium: 6500 },
            { type: '시외', dest: '계성', region: '덕북권', freq: '5회', company: '청엽, 소진', dist: 90.06, normal: 8300, premium: 10800 },
            { type: '시외', dest: '낭원', region: '덕북권', freq: '35회', company: '청엽, 소진', dist: 89.27, normal: 8200, premium: 10700 },
            { type: '시외', dest: '대현', region: '덕북권', freq: '25~26회', company: '칠양, 소진', dist: 130.52, normal: 11400, premium: 14900 },
            { type: '시외', dest: '덕현', region: '덕북권', freq: '50회', company: '칠양, 효빈, 청엽', dist: 107.61, normal: 9650, premium: 12600 },
            { type: '시외', dest: '모제', region: '덕북권', freq: '5회', company: '칠양고속', dist: 66.3, normal: 6400, premium: 8400 },
            { type: '시외', dest: '반양', region: '덕북권', freq: '5회', company: '청엽, 소진', dist: 90.06, normal: 8300, premium: 10800 },
            { type: '시외', dest: '산백', region: '덕북권', freq: '36회', company: '청엽, 효빈', dist: 82.18, normal: 7700, premium: 10100 },
            { type: '시외', dest: '삽곡', region: '덕북권', freq: '5회', company: '청엽, 소진', dist: 85.63, normal: 7900, premium: 10300 },
            { type: '시외', dest: '상안', region: '덕북권', freq: '31회', company: '청엽, 소진', dist: 96.64, normal: 8800, premium: 11500 },
            { type: '시외', dest: '서중', region: '덕북권', freq: '55회', company: '칠양, 소진, 덕주', dist: 95.04, normal: 8700, premium: 11400 },
            { type: '시외', dest: '서진', region: '덕북권', freq: '7회', company: '청엽, 소진', dist: 81.68, normal: 7600, premium: 9900 },
            { type: '시외', dest: '서해', region: '덕북권', freq: '7회', company: '청엽, 소진', dist: 103.25, normal: 9300, premium: 12100 },
            { type: '시외', dest: '선곡', region: '덕북권', freq: '6회', company: '청엽, 칠양', dist: 32.68, normal: 3800, premium: 5000 },
            { type: '시외', dest: '약산', region: '덕북권', freq: '4회', company: '효빈고속', dist: 41, normal: 4450, premium: 5800 },
            { type: '시외', dest: '엽월', region: '덕북권', freq: '22회', company: '청엽, 덕빈', dist: 78.71, normal: 7400, premium: 9700 },
            { type: '시외', dest: '우구', region: '덕북권', freq: '36회', company: '청엽, 효빈', dist: 85.72, normal: 7900, premium: 10300 },
            { type: '시외', dest: '원강', region: '덕북권', freq: '7회', company: '청엽, 효빈', dist: 54.56, normal: 5500, premium: 7200 },
            { type: '시외', dest: '원전', region: '덕북권', freq: '10회', company: '청엽, 효빈', dist: 28.27, normal: 3450, premium: 4500 },
            { type: '시외', dest: '인자', region: '덕북권', freq: '22회', company: '청엽, 덕빈', dist: 74.49, normal: 7100, premium: 9300 },
            { type: '시외', dest: '저천', region: '덕북권', freq: '36회', company: '청엽, 효빈', dist: 93.98, normal: 8600, premium: 11200 },
            { type: '시외', dest: '전산', region: '덕북권', freq: '24회', company: '청엽, 소진', dist: 86.7, normal: 8000, premium: 10400 },
            { type: '시외', dest: '전포', region: '덕북권', freq: '35회', company: '청엽, 소진', dist: 81.33, normal: 7600, premium: 9900 },
            { type: '시외', dest: '천주', region: '덕북권', freq: '7회', company: '효빈, 청엽', dist: 68.49, normal: 6600, premium: 8600 },
            { type: '시외', dest: '청선', region: '덕북권', freq: '46회', company: '칠양, 효빈, 청엽', dist: 67.93, normal: 6550, premium: 8600 },
            { type: '시외', dest: '치원', region: '덕북권', freq: '12회', company: '청엽, 칠양', dist: 61.91, normal: 6100, premium: 8000 },
            { type: '시외', dest: '판주', region: '덕북권', freq: '15회', company: '효빈고속', dist: 92.6, normal: 8500, premium: 11100 },
            { type: '시외', dest: '하미', region: '덕북권', freq: '10회', company: '청엽, 효빈', dist: 37.15, normal: 4150, premium: 5400 },
            { type: '시외', dest: '화원', region: '덕북권', freq: '33회', company: '칠양, 효빈, 청엽', dist: 100.31, normal: 9100, premium: 11900 },
            { type: '시외', dest: '후등', region: '덕북권', freq: '8회', company: '칠양고속', dist: 54.89, normal: 5500, premium: 7200 },
            { type: '시외', dest: '흑성', region: '덕북권', freq: '33회', company: '칠양, 효빈, 청엽', dist: 91.16, normal: 8400, premium: 11000 },
            { type: '시외', dest: '남부', region: '효빈시내', freq: '수시', company: '효빈여객', dist: 6.98, normal: 1600, premium: 2100 },
            
            // 덕빈권 (주요 거점)
            { type: '고속,시외', dest: '군천', region: '덕빈권', freq: '20회', company: '덕빈, 효빈', dist: 94.56, normal: 7100, premium: 10600 },
            { type: '고속,시외', dest: '덕주', region: '덕빈권', freq: '55회', company: '덕빈, 효빈', dist: 136.74, normal: 10200, premium: 15200 },
            { type: '고속,시외', dest: '빈주', region: '덕빈권', freq: '10회', company: '덕빈고속', dist: 74.54, normal: 5600, premium: 8300 },
            { type: '시외', dest: '낙주', region: '덕빈권', freq: '30회', company: '덕빈고속', dist: 158.28, normal: 13600, premium: 17700 },

            // 덕남권
            { type: '시외', dest: '고포', region: '덕남권', freq: '9회', company: '소진고속', dist: 223.03, normal: 18450, premium: 24000 },
            { type: '시외', dest: '곡천', region: '덕남권', freq: '13회', company: '소진고속', dist: 198.39, normal: 16700, premium: 21800 },
            { type: '시외', dest: '관수', region: '덕남권', freq: '33회', company: '소진고속', dist: 172.8, normal: 14700, premium: 19200 },
            { type: '시외', dest: '두원', region: '덕남권', freq: '15회', company: '소진고속', dist: 192.63, normal: 16300, premium: 21200 },
            { type: '시외', dest: '마진', region: '덕남권', freq: '28회', company: '소진고속', dist: 175, normal: 14900, premium: 19400 },
            { type: '시외', dest: '매성', region: '덕남권', freq: '16회', company: '칠양고속', dist: 146.07, normal: 12650, premium: 16500 },
            { type: '시외', dest: '방산', region: '덕남권', freq: '55회', company: '칠양, 소진, 덕주', dist: 107.25, normal: 9600, premium: 12500 },
            { type: '시외', dest: '분주', region: '덕남권', freq: '30회', company: '칠양, 덕주', dist: 152.6, normal: 13200, premium: 17200 },
            { type: '시외', dest: '비천', region: '덕남권', freq: '12회', company: '칠양고속', dist: 155.52, normal: 13400, premium: 17500 },
            { type: '시외', dest: '석창', region: '덕남권', freq: '50회', company: '칠양, 소진, 덕주', dist: 118.29, normal: 10500, premium: 13700 },
            { type: '시외', dest: '운진', region: '덕남권', freq: '41회', company: '칠양, 소진, 덕주', dist: 202.93, normal: 17100, premium: 22300 },
            { type: '시외', dest: '원명', region: '덕남권', freq: '30회', company: '칠양, 덕주', dist: 142.67, normal: 12400, premium: 16200 },
            { type: '시외', dest: '이율', region: '덕남권', freq: '25~26회', company: '칠양, 소진', dist: 120.67, normal: 10700, premium: 14000 },
            { type: '시외', dest: '인곡', region: '덕남권', freq: '20회', company: '덕주고속', dist: 174.18, normal: 14800, premium: 19300 },
            { type: '시외', dest: '하정', region: '덕남권', freq: '25~26회', company: '칠양, 소진', dist: 127.93, normal: 11200, premium: 14600 },

            // 호남권
            { type: '시외', dest: '순천', region: '호남권', freq: '19회', company: '덕빈고속', dist: 253.81, normal: 20600, premium: 26800 },
            { type: '시외', dest: '여수', region: '호남권', freq: '15회', company: '덕빈고속', dist: 279, normal: 22300, premium: 29000 },
            { type: '시외', dest: '광양', region: '호남권', freq: '11회', company: '덕빈고속', dist: 274.08, normal: 22000, premium: 28600 },
            { type: '시외', dest: '나주', region: '호남권', freq: '8회', company: '금호고속', dist: 188.85, normal: 16000, premium: 20800 },
            { type: '시외', dest: '해남', region: '호남권', freq: '3회', company: '덕빈고속', dist: 199.59, normal: 16800, premium: 21900 },
            { type: '시외', dest: '남원', region: '호남권', freq: '6회', company: '호남고속', dist: 235.47, normal: 19300, premium: 25100 },
            { type: '시외', dest: '군산', region: '호남권', freq: '15회', company: '전북, 덕빈', dist: 284.76, normal: 22700, premium: 29600 },
            { type: '시외', dest: '서천', region: '호남권', freq: '6회', company: '덕빈, 충남', dist: 296.6, normal: 23500, premium: 30600 },
            { type: '고속,시외', dest: '광주', region: '호남권', freq: '32회', company: '덕빈, 칠양', dist: 179.99, normal: 13400, premium: 19900 },
            { type: '고속,시외', dest: '전주', region: '호남권', freq: '30회', company: '덕빈, 칠양', dist: 257.96, normal: 18700, premium: 27700 },
            { type: '시외', dest: '목포', region: '호남권', freq: '9회', company: '덕빈고속', dist: 150.78, normal: 13000, premium: 16900 },

            // 수도권
            { type: '고속', dest: '논산', region: '충청권', freq: '4~5회', company: '덕빈, 중앙', dist: 301.04, normal: 21500, premium: 31900 },
            { type: '고속', dest: '유성', region: '충청권', freq: '13회', company: '덕빈, 칠양', dist: 332.34, normal: 23600, premium: 35000 },
            { type: '고속', dest: '세종', region: '충청권', freq: '4~5회', company: '덕빈, 중앙', dist: 348.66, normal: 24700, premium: 36600 },
            { type: '고속', dest: '대전복합', region: '충청권', freq: '24회', company: '칠양, 중앙', dist: 327, normal: 23200, premium: 34400 },
            { type: '고속', dest: '청주', region: '충청권', freq: '5회', company: '덕빈, 속리산', dist: 360.22, normal: 25400, premium: 37700 },
            { type: '고속', dest: '천안', region: '충청권', freq: '9회', company: '덕빈, 대원, 속리산', dist: 375.75, normal: 26600, premium: 39400 },
            { type: '고속', dest: '아산', region: '충청권', freq: '9회', company: '덕빈, 대원, 속리산', dist: 373.12, normal: 26400, premium: 39100 },
            { type: '고속', dest: '정안휴게소', region: '충청권', freq: '-', company: '-', dist: 346.59, normal: 24800, premium: 36800 },
            { type: '시외', dest: '서산', region: '충청권', freq: '5회', company: '덕빈고속', dist: 385.26, normal: 29650, premium: 38600 },
            { type: '시외', dest: '당진', region: '충청권', freq: '6회', company: '덕빈, 충남', dist: 394.89, normal: 30300, premium: 39400 },
            { type: '시외', dest: '충주', region: '충청권', freq: '3회', company: '광신, 서울', dist: 418.39, normal: 31800, premium: 41400 },
            { type: '시외', dest: '증평', region: '충청권', freq: '3회', company: '광신, 서울', dist: 381.13, normal: 29400, premium: 38300 },

            // 영남권
            { type: '시외', dest: '통영', region: '영남권', freq: '4회', company: '대산고속', dist: 357.43, normal: 27700, premium: 36100 },
            { type: '시외', dest: '거제', region: '영남권', freq: '4회', company: '대산고속', dist: 379.68, normal: 29300, premium: 38100 },
            { type: '시외', dest: '장승포', region: '영남권', freq: '4회', company: '대산고속', dist: 390.67, normal: 30000, premium: 39000 },
            { type: '고속', dest: '마산', region: '영남권', freq: '3회', company: '덕빈, 칠양', dist: 371.8, normal: 26200, premium: 38800 },
            { type: '고속', dest: '창원', region: '영남권', freq: '3회', company: '덕빈, 칠양', dist: 375.43, normal: 26400, premium: 39100 },
            { type: '고속', dest: '진해', region: '영남권', freq: '3회', company: '덕빈, 칠양', dist: 385.26, normal: 27100, premium: 40200 },
            { type: '고속', dest: '부산서부', region: '영남권', freq: '22~24회', company: '덕빈, 칠양', dist: 411.73, normal: 28700, premium: 42500 },
            { type: '고속', dest: '부산(노포동)', region: '영남권', freq: '15~19회', company: '덕빈, 칠양', dist: 425.03, normal: 29500, premium: 43700 },
            { type: '고속', dest: '울산', region: '영남권', freq: '6회', company: '덕빈, 칠양', dist: 457.94, normal: 31500, premium: 46700 },
            { type: '시외', dest: '대구', region: '대경권', freq: '5회', company: '대산고속', dist: 408.12, normal: 31200, premium: 40600 },
            { type: '시외', dest: '구미', region: '대경권', freq: '3회', company: '경북고속', dist: 421.58, normal: 32000, premium: 41600 },

            // 강원권
            { type: '시외', dest: '영월', region: '강원권', freq: '1회', company: '효빈고속', dist: 551.62, normal: 40200, premium: 52300 },
            { type: '시외', dest: '태백', region: '강원권', freq: '1회', company: '효빈고속', dist: 602.48, normal: 43400, premium: 56500 },
            { type: '시외', dest: '강릉', region: '강원권', freq: '1~2회', company: '효빈고속', dist: 628.62, normal: 45100, premium: 58700 },
            { type: '고속', dest: '춘천', region: '강원권', freq: '2~3회', company: '칠양고속', dist: 533.19, normal: 36000, premium: 53400 },
            { type: '고속', dest: '원주', region: '강원권', freq: '4~5회', company: '덕빈, 중앙', dist: 460.48, normal: 31700, premium: 47000 },

            // 수도권 (나머지)
            { type: '고속', dest: '정안휴게소', region: '충청권', freq: '-', company: '-', dist: 346.59, normal: 24800, premium: 36800 },
            { type: '고속', dest: '평택', region: '수도권', freq: '13회', company: '덕빈고속', dist: 396.98, normal: 27800, premium: 41200 },
            { type: '고속', dest: '용인', region: '수도권', freq: '6~8회', company: '효빈, 칠양', dist: 430.35, normal: 29800, premium: 44200 },
            { type: '고속', dest: '분당', region: '수도권', freq: '8회', company: '중앙고속', dist: 452.63, normal: 31200, premium: 46200 },
            { type: '고속', dest: '동서울', region: '수도권', freq: '7/9회', company: '칠양, 청엽', dist: 462.47, normal: 31800, premium: 47100 },
            { type: '고속', dest: '서울', region: '수도권', freq: '10~15분', company: '칠양, 효빈', dist: 457.33, normal: 31500, premium: 46700 },
            { type: '고속', dest: '고양(백석)', region: '수도권', freq: '2회', company: '효빈고속', dist: 484.11, normal: 33100, premium: 49100 },
            { type: '고속', dest: '안산', region: '수도권', freq: '7회', company: '효빈고속', dist: 440.43, normal: 30500, premium: 45200 },
            { type: '고속', dest: '시흥', region: '수도권', freq: '7회', company: '효빈고속', dist: 453.09, normal: 31200, premium: 46200 },
            { type: '시외', dest: '부천', region: '수도권', freq: '14회', company: '덕빈, 효빈, 경기', dist: 463.86, normal: 34700, premium: 45200 },
            { type: '고속', dest: '인천', region: '수도권', freq: '17/23회', company: '칠양, 한일', dist: 464.15, normal: 31900, premium: 47300 },
            { type: '고속', dest: '인천국제공항', region: '수도권', freq: '25회', company: '덕빈, 효빈', dist: 489.07, normal: 33400, premium: 49500 },
            { type: '시외', dest: '이천', region: '수도권', freq: '15회', company: '효빈, 덕빈', dist: 438.1, normal: 33100, premium: 43100 },
            { type: '시외', dest: '오산', region: '수도권', freq: '14회', company: '효빈고속', dist: 410, normal: 30300, premium: 39400 },
            { type: '시외', dest: '안성(공도)', region: '수도권', freq: '2회', company: '효빈고속', dist: 395.75, normal: 30400, premium: 39600 }
        ];

        // 2. 테이블 렌더링 함수
        function renderRoutes() {
            const tbody = document.getElementById('route-table-body');
            tbody.innerHTML = '';
            
            // 정렬 순서
            const regionOrder = { 
                '수도권': 1, '강원권': 2, '충청권': 3, '대경권': 4, 
                '호남권': 5, '영남권': 6, '덕빈권': 7, '덕북권': 8, '덕남권': 9, '효빈시내': 10 
            };
            
            rawRouteData.sort((a, b) => {
                const orderA = regionOrder[a.region] || 99;
                const orderB = regionOrder[b.region] || 99;
                if (orderA !== orderB) return orderA - orderB;
                if (a.dest < b.dest) return -1;
                if (a.dest > b.dest) return 1;
                return 0;
            });

            rawRouteData.forEach(route => {
                let badgeClass = '';
                if (route.type.includes('고속')) badgeClass = 'tag-express';
                else if (route.type.includes('시외')) badgeClass = 'tag-intercity';
                else badgeClass = 'tag-mixed';

                const tr = document.createElement('tr');
                tr.className = 'route-row';
                tr.onclick = () => startBookingFlow(route);

                tr.innerHTML = `
                    <td><span class="tag-bus ${badgeClass}">${route.type}</span></td>
                    <td class="font-bold text-gray-800">${route.dest}</td>
                    <td class="text-gray-600">${route.region}</td>
                    <td class="text-gray-500">${route.freq}</td>
                    <td class="text-gray-500">${route.company}</td>
                    <td class="text-gray-500">${route.dist} km</td>
                    <td class="font-medium">${route.normal.toLocaleString()}원</td>
                    <td class="text-gray-500">${route.premium.toLocaleString()}원</td>
                `;
                tbody.appendChild(tr);
            });
        }

        // --- 모달 & 예매 로직 ---
        function parseFrequency(frequencyStr) {
            // "10~15분" -> 약 60회 이상
            if (frequencyStr.includes('분')) {
                const match = frequencyStr.match(/(\d+)/);
                const interval = match ? parseInt(match[1]) : 15;
                let departures = Math.floor(960 / interval); // 06:00~22:00 (16시간 = 960분)
                return Math.min(departures, 60); // 최대 60개 제한
            }
            // "7회", "17/23회" -> 숫자 추출
            const matches = frequencyStr.match(/(\d+)/g);
            if (matches && matches.length > 0) {
                 // 범위나 슬래시가 있으면 큰 숫자(최대 횟수) 기준
                return Math.max(...matches.map(Number));
            }
            return 3; // 기본값
        }

        function generateSchedule(route) {
            const dailyDepartures = parseFrequency(route.freq);
            const schedules = [];
            const startHour = 6; // 첫차 06:00
            const endHour = 22;  // 막차 22:00
            const totalMinutes = (endHour - startHour) * 60;
            const interval = Math.floor(totalMinutes / Math.max(dailyDepartures - 1, 1));
            
            let currentMin = startHour * 60;

            for (let i = 0; i < dailyDepartures; i++) {
                const h = Math.floor(currentMin / 60);
                const m = currentMin % 60;
                
                // 시간 포맷 (HH:MM)
                const timeStr = `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}`;
                
                // 등급 및 가격 결정
                // 심야(22시 이후)는 프리미엄 가격 적용 등 단순화
                let seatClass = '일반';
                let price = route.normal;

                if (route.type.includes('고속')) {
                    // 고속버스는 우등 비율 높음
                    if (i % 3 !== 0) { 
                        seatClass = '우등'; 
                        price = route.premium; 
                    }
                } else {
                    // 시외버스는 일부 시간대 우등
                     if (i % 4 === 0) {
                        seatClass = '우등';
                        price = route.premium;
                    }
                }

                schedules.push({ time: timeStr, class: seatClass, price: price });
                
                currentMin += interval;
                if(currentMin >= 23 * 60) break; 
            }
            return schedules;
        }

        let selectedRoute = null;

        function startBookingFlow(route) {
            selectedRoute = route;
            renderBookingStep1();
            openModal('booking-modal');
        }

        function renderBookingStep1() {
            const titleEl = document.getElementById('booking-title');
            const contentEl = document.getElementById('booking-content');
            titleEl.innerText = '노선 예매 (1/3)';
            
            const schedules = generateSchedule(selectedRoute);
            let timesHtml = schedules.map(s => 
                `<option value="${s.time}|${s.class}|${s.price}">
                    ${s.time} - ${s.class} (${s.price.toLocaleString()}원)
                </option>`
            ).join('');

            contentEl.innerHTML = `
                <div class="space-y-4">
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h4 class="text-xl font-bold text-blue-800 mb-1">${selectedRoute.dest} 행</h4>
                        <p class="text-sm text-blue-600">
                           ${selectedRoute.region} | 거리: ${selectedRoute.dist}km<br>
                           운행사: ${selectedRoute.company}
                        </p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">출발 시간 및 등급 선택</label>
                        <select id="booking-time-select" class="w-full p-3 border border-gray-300 rounded-lg">
                            ${timesHtml}
                        </select>
                    </div>
                    <button onclick="renderBookingStep2()" class="w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg transition">다음 단계 (결제)</button>
                </div>
            `;
        }

        function renderBookingStep2() {
            const selectEl = document.getElementById('booking-time-select');
            const [time, seatClass, price] = selectEl.value.split('|');
            const titleEl = document.getElementById('booking-title');
            const contentEl = document.getElementById('booking-content');
            
            titleEl.innerText = '결제 진행 (2/3)';
            contentEl.innerHTML = `
                <div class="space-y-5">
                    <div class="border-b pb-4">
                        <p class="text-gray-500 text-sm">선택한 여정</p>
                        <p class="text-lg font-bold">효빈 → ${selectedRoute.dest}</p>
                        <p class="text-gray-800">${time} 출발 | ${seatClass}</p>
                    </div>
                    <div class="flex justify-between items-center text-xl font-bold">
                        <span>총 결제금액</span>
                        <span class="text-red-600">${parseInt(price).toLocaleString()}원</span>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">결제 수단</label>
                        <select class="w-full p-2 border rounded"><option>신용/체크카드</option><option>간편결제 (페이)</option><option>휴대폰 결제</option></select>
                    </div>
                    <button onclick="renderBookingStep3()" class="w-full py-3 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg transition">결제하기</button>
                </div>
            `;
        }

        function renderBookingStep3() {
            const titleEl = document.getElementById('booking-title');
            const contentEl = document.getElementById('booking-content');
            titleEl.innerText = '예매 완료 (3/3)';
            contentEl.innerHTML = `
                <div class="text-center py-6">
                    <div class="w-16 h-16 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-4"><i data-lucide="check" class="w-8 h-8"></i></div>
                    <h4 class="text-2xl font-bold text-gray-800 mb-2">예매가 완료되었습니다!</h4>
                    <p class="text-gray-600 mb-6">모바일 티켓이 발권되었습니다.<br>탑승 시 QR코드를 스캔해주세요.</p>
                    <button onclick="closeModal('booking-modal')" class="px-6 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold rounded-lg transition">닫기</button>
                </div>
            `;
            lucide.createIcons();
        }

        function openModal(id) {
            const modal = document.getElementById(id);
            const wrapperId = id === 'booking-modal' ? 'booking-modal-wrapper' : 'generic-modal-wrapper';
            const wrapper = document.getElementById(wrapperId);
            modal.classList.remove('hidden');
            setTimeout(() => wrapper.classList.remove('scale-95', 'opacity-0'), 10);
            lucide.createIcons();
        }

        function closeModal(id) {
            const modal = document.getElementById(id);
            const wrapperId = id === 'booking-modal' ? 'booking-modal-wrapper' : 'generic-modal-wrapper';
            const wrapper = document.getElementById(wrapperId);
            wrapper.classList.add('scale-95', 'opacity-0');
            setTimeout(() => modal.classList.add('hidden'), 300);
        }

        function openInfoModal(key) {
            const data = detailsData[key];
            if (data) {
                document.getElementById('generic-modal-title').innerText = data.title;
                document.getElementById('generic-modal-content').innerHTML = data.content;
                openModal('generic-modal');
            }
        }

        window.onload = () => { renderRoutes(); };
    </script>
</body>
</html>